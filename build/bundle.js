function requireES6(module,impName){if(!module){return undefined;}if(module.hasES6Exports){if(impName==='*'){return module.es6;}return module.es6[impName];}if(impName=='*'||impName==='default'){return module.exports;}return module.exports[impName];}function require(module){if(module.hasES6Exports){return module.es6;}return module.exports;}var moduleFns={},modules={};var process={env:{}};moduleFns.src_index_js=function(){var module={exports:{},es6:{},hasES6Exports:false},exports=module.exports;return module};moduleFns.src_entityTypes_js=function(){var module={exports:{},es6:{},hasES6Exports:true},exports=module.exports;var addEntityType=requireES6(modules.src_engine_engine_js,'addEntityType'),settings=requireES6(modules.src_engine_engine_js,'settings');var updateMario=requireES6(modules.src_entities_mario_js,'updateMario');var updateWall=requireES6(modules.src_entities_wall_js,'updateWall');var updateGoomba=requireES6(modules.src_entities_goomba_js,'updateGoomba');var updateCoin=requireES6(modules.src_entities_coin_js,'updateCoin');const ENTITY_TYPE_MARIO=requireES6(modules.src_engine_engine_js,'addEntityType')('@',requireES6(modules.src_entities_mario_js,'updateMario'),{bbox:{left:-0.5,top:0,width:1,height:1}});module.es6.ENTITY_TYPE_MARIO=ENTITY_TYPE_MARIO;const ENTITY_TYPE_WALL=requireES6(modules.src_engine_engine_js,'addEntityType')('#',requireES6(modules.src_entities_wall_js,'updateWall'),{bbox:{left:0,top:0,width:requireES6(modules.src_engine_engine_js,'settings').tileSize,height:requireES6(modules.src_engine_engine_js,'settings').tileSize}});module.es6.ENTITY_TYPE_WALL=ENTITY_TYPE_WALL;const ENTITY_TYPE_GOOMBA=requireES6(modules.src_engine_engine_js,'addEntityType')('G',requireES6(modules.src_entities_goomba_js,'updateGoomba'),{bbox:{left:-0.5,top:0,width:1,height:1}});module.es6.ENTITY_TYPE_GOOMBA=ENTITY_TYPE_GOOMBA;const ENTITY_TYPE_COIN=requireES6(modules.src_engine_engine_js,'addEntityType')('0',requireES6(modules.src_entities_coin_js,'updateCoin'),{bbox:{left:0,top:0,width:1,height:1}});module.es6.ENTITY_TYPE_COIN=ENTITY_TYPE_COIN;return module};moduleFns.src_entities_mario_js=function(){var module={exports:{},es6:{},hasES6Exports:true},exports=module.exports;var addEntityType=requireES6(modules.src_engine_engine_js,'addEntityType'),drawSprite=requireES6(modules.src_engine_engine_js,'drawSprite'),keys=requireES6(modules.src_engine_engine_js,'keys'),keyCode=requireES6(modules.src_engine_engine_js,'keyCode'),time=requireES6(modules.src_engine_engine_js,'time'),settings=requireES6(modules.src_engine_engine_js,'settings'),playSound=requireES6(modules.src_engine_engine_js,'playSound'),removeEntity=requireES6(modules.src_engine_engine_js,'removeEntity'),camera=requireES6(modules.src_engine_engine_js,'camera'),addEntity=requireES6(modules.src_engine_engine_js,'addEntity'),moveAndCheckForObstacles=requireES6(modules.src_engine_engine_js,'moveAndCheckForObstacles'),stopSound=requireES6(modules.src_engine_engine_js,'stopSound'),checkCollision=requireES6(modules.src_engine_engine_js,'checkCollision');var ENTITY_TYPE_WALL=requireES6(modules.src_entityTypes_js,'ENTITY_TYPE_WALL'),ENTITY_TYPE_MARIO=requireES6(modules.src_entityTypes_js,'ENTITY_TYPE_MARIO');var assets=requireES6(modules.src_assets_js,'default');function updateMario(mario){requireES6(modules.src_engine_engine_js,'drawSprite')(requireES6(modules.src_assets_js,'default').sprMarioIdle,mario);}module.es6.updateMario=updateMario;return module};moduleFns.src_entities_coin_js=function(){var module={exports:{},es6:{},hasES6Exports:true},exports=module.exports;var addEntityType=requireES6(modules.src_engine_engine_js,'addEntityType'),drawSprite=requireES6(modules.src_engine_engine_js,'drawSprite'),keys=requireES6(modules.src_engine_engine_js,'keys'),keyCode=requireES6(modules.src_engine_engine_js,'keyCode'),time=requireES6(modules.src_engine_engine_js,'time'),settings=requireES6(modules.src_engine_engine_js,'settings'),playSound=requireES6(modules.src_engine_engine_js,'playSound'),removeEntity=requireES6(modules.src_engine_engine_js,'removeEntity'),camera=requireES6(modules.src_engine_engine_js,'camera'),addEntity=requireES6(modules.src_engine_engine_js,'addEntity'),moveAndCheckForObstacles=requireES6(modules.src_engine_engine_js,'moveAndCheckForObstacles'),stopSound=requireES6(modules.src_engine_engine_js,'stopSound'),checkCollision=requireES6(modules.src_engine_engine_js,'checkCollision');var ENTITY_TYPE_WALL=requireES6(modules.src_entityTypes_js,'ENTITY_TYPE_WALL'),ENTITY_TYPE_MARIO=requireES6(modules.src_entityTypes_js,'ENTITY_TYPE_MARIO');var assets=requireES6(modules.src_assets_js,'default');function updateCoin(coin){requireES6(modules.src_engine_engine_js,'drawSprite')(requireES6(modules.src_assets_js,'default').sprCoin,coin,0.05);}module.es6.updateCoin=updateCoin;return module};moduleFns.src_engine_engine_js=function(){var module={exports:{},es6:{},hasES6Exports:true},exports=module.exports;var utils=requireES6(modules.src_engine_utils_js,'default');const SCALING_FACTOR=4;const _canvas=document.querySelector('#game');_canvas.style.imageRendering='pixelated';_canvas.width=300;_canvas.height=200;_canvas.style.width=_canvas.width*SCALING_FACTOR;_canvas.style.height=_canvas.height*SCALING_FACTOR;const _ctx=_canvas.getContext('2d');const _settings={pixelsPerMeter:16,tileSize:1,timeSpeed:1,gravity:20};const _entityTypesObj={};const _entityList=requireES6(modules.src_engine_utils_js,'default').unorderedList();const _keyCode={SPACE:32,ARROW_LEFT:37,ARROW_UP:38,ARROW_RIGHT:39,ARROW_DOWN:40};const _keys={};const _timeInfo={deltaTime:0,totalTime:0,prevFrameTime:performance.now()};const _camera={x:_canvas.width/2/_settings.pixelsPerMeter,y:_canvas.height/2/_settings.pixelsPerMeter,width:_canvas.width/_settings.pixelsPerMeter,height:_canvas.height/_settings.pixelsPerMeter};Object.values(_keyCode).forEach((code)=>(_keys[code]={isDown:false,wentDown:false,wentUp:false}));mainGameLoop();const apiAddEntityType=(mapSymbol,updateFunc,defaultState)=>addEntityType(_entityTypesObj,mapSymbol,updateFunc,defaultState);const apiAddEntity=(type)=>addEntity(_entityTypesObj,_entityList,type);const apiRemoveEntity=(entity)=>removeEntity(_entityList,entity);const apiCreateMap=(asciiMapRows)=>createMap(_entityTypesObj,_entityList,_settings,asciiMapRows);const apiDrawSprite=(sprite,entity,animationSpeed,scaleX,scaleY)=>drawSprite(_ctx,sprite,entity,animationSpeed,scaleX,scaleY);const apiDrawRect=(x,y,width,height,color)=>drawRect(_ctx,x,y,width,height,color);const apiCheckCollision=(entity,otherTypes,offsetX,offsetY)=>checkCollision(_entityList,entity,otherTypes,offsetX,offsetY);const apiMoveAndCheckForObstacles=(entity,otherTypes)=>moveAndCheckForObstacles(_entityList,_timeInfo,entity,otherTypes);const apiDrawText=(text,x,y,color)=>drawText(_ctx,text,x,y,color);module.es6.settings=_settings,module.es6.keyCode=_keyCode,module.es6.keys=_keys,module.es6.time=_timeInfo,module.es6.camera=_camera,module.es6.addEntityType=apiAddEntityType,module.es6.addEntity=apiAddEntity,module.es6.removeEntity=apiRemoveEntity,module.es6.createMap=apiCreateMap,module.es6.loadSprite=loadSprite,module.es6.drawSprite=apiDrawSprite,module.es6.drawRect=apiDrawRect,module.es6.loadSound=loadSound,module.es6.playSound=playSound,module.es6.stopSound=stopSound,module.es6.checkCollision=apiCheckCollision,module.es6.moveAndCheckForObstacles=apiMoveAndCheckForObstacles,module.es6.drawText=apiDrawText;function addEntityType(entityTypesObj,mapSymbol,updateFunc,defaultState={}){entityTypesObj[mapSymbol]={updateFunc,defaultState};return mapSymbol;}function addEntity(entityTypesObj,entityList,type){const entity={x:0,y:0,bbox:{left:0,top:0,width:0,height:0},speedX:0,speedY:0,type,index:0,isInitialized:false};const typeInfo=entityTypesObj[type];Object.assign(entity,typeInfo.defaultState);entity.index=entityList.add(entity);return entity;}function removeEntity(entityList,entity){entityList.remove(entity.index);}function createMap(entityTypesObj,entityList,globalSettings,asciiMapRows){for(let y=0;y<asciiMapRows.length;y++){const row=asciiMapRows[y];for(let x=0;x<row.length;x++){if(entityTypesObj[row[x]]){const e=addEntity(_entityTypesObj,entityList,row[x]);e.x=x*globalSettings.tileSize;e.y=y*globalSettings.tileSize;}}}}document.onkeydown=function(event){const key=_keys[event.keyCode];if(!key){return;}if(!key.isDown){key.wentDown=true;key.isDown=true;}};document.onkeyup=function(event){const key=_keys[event.keyCode];if(!key){return;}if(key.isDown){key.wentUp=true;key.isDown=false;}};function mainGameLoop(){_camera.width=_canvas.width/_settings.pixelsPerMeter;_camera.height=_canvas.height/_settings.pixelsPerMeter;_ctx.fillStyle='#444';_ctx.fillRect(0,0,_canvas.width,_canvas.height);_ctx.save();_ctx.translate(-(_camera.x*_settings.pixelsPerMeter-_canvas.width/2),-(_camera.y*_settings.pixelsPerMeter-_canvas.height/2));for(let index=0;index<_entityList.items.length;index++){const entity=_entityList.items[index];if(entity!==requireES6(modules.src_engine_utils_js,'default').unorderedList.REMOVED_ITEM){const typeInfo=_entityTypesObj[entity.type];if(typeInfo.updateFunc){typeInfo.updateFunc(entity);}}}_ctx.restore();Object.values(_keys).forEach((key)=>{key.wentDown=false;key.wentUp=false;});const newTime=performance.now();_timeInfo.deltaTime=(newTime-_timeInfo.prevFrameTime)*0.001*_settings.timeSpeed;if(_timeInfo.deltaTime>0.1){_timeInfo.deltaTime=0.016;}_timeInfo.totalTime+=_timeInfo.deltaTime;_timeInfo.prevFrameTime=newTime;requestAnimationFrame(mainGameLoop);}function loadSprite(fileName,offsetX=0,offsetY=0,frameCount=1){const img=new Image();img.src=fileName;const sprite={bitmap:img,width:0,height:0,offsetX,offsetY,frameCount,entityFrameMap:new Map()};img.onload=()=>{sprite.width=img.width/frameCount;sprite.height=img.height;};return sprite;}function drawSprite(ctx,sprite,entity,animationSpeed=0,scaleX=1,scaleY=1){let savedFrame=sprite.entityFrameMap.get(entity)||0;const currentFrame=Math.floor(savedFrame);savedFrame+=animationSpeed;if(savedFrame>=sprite.frameCount){savedFrame=0;}sprite.entityFrameMap.set(entity,savedFrame);const factor=_settings.pixelsPerMeter/16;ctx.save();ctx.scale(scaleX*factor,scaleY*factor);ctx.drawImage(sprite.bitmap,currentFrame*sprite.width,0,sprite.width,sprite.height,entity.x*scaleX*16+sprite.offsetX,entity.y*scaleY*16+sprite.offsetY,sprite.width,sprite.height);ctx.restore();}function drawRect(ctx,x,y,width,height,color){ctx.fillStyle=color;ctx.fillRect(x*_settings.pixelsPerMeter,y*_settings.pixelsPerMeter,width*_settings.pixelsPerMeter,height*_settings.pixelsPerMeter);}function loadSound(fileName){const sound=new Audio(fileName);sound.volume=0.02;return sound;}function playSound(sound,loop=false,volume=0.02){sound.currentTime=0;sound.pause();sound.loop=loop;sound.volume=volume;sound.play();}function stopSound(sound){sound.currentTime=0;sound.pause();}function checkCollision(entityList,entity,otherEntityTypes,offsetX=0,offsetY=0){for(let other of entityList.items){if(other!==requireES6(modules.src_engine_utils_js,'default').unorderedList.REMOVED_ITEM&&entity!==other){if(!otherEntityTypes.includes(other.type)){continue;}const eLeft=entity.x+offsetX+entity.bbox.left;const eTop=entity.y+offsetY+entity.bbox.top;const eRight=eLeft+entity.bbox.width;const eBottom=eTop+entity.bbox.height;const oLeft=other.x+other.bbox.left;const oTop=other.y+other.bbox.top;const oRight=oLeft+other.bbox.width;const oBottom=oTop+other.bbox.height;const eps=0.000001;if(eLeft>=oRight-eps||eRight<=oLeft+eps||eTop>=oBottom-eps||eBottom<=oTop+eps){continue;}return other;}}return null;}function moveAndCheckForObstacles(entityList,time,entity,otherTypes){const horizWall=checkCollision(entityList,entity,otherTypes,entity.speedX*time.deltaTime,0);if(horizWall){if(entity.speedX>0){entity.x=horizWall.x+horizWall.bbox.left-entity.bbox.left-entity.bbox.width;}else {entity.x=horizWall.x+horizWall.bbox.left+horizWall.bbox.width-entity.bbox.left;}entity.speedX=0;}const vertWall=checkCollision(_entityList,entity,otherTypes,entity.speedX*time.deltaTime,entity.speedY*time.deltaTime);if(vertWall){if(entity.speedY>0){entity.y=vertWall.y+vertWall.bbox.top-entity.bbox.top-entity.bbox.height;entity.speedY=0;}else {entity.y=vertWall.y+vertWall.bbox.top+vertWall.bbox.height-entity.bbox.top;entity.speedY*=-0.5;}}entity.x+=entity.speedX*time.deltaTime;entity.y+=entity.speedY*time.deltaTime;return {horizWall,vertWall};}function drawText(ctx,text,x,y,color){ctx.fillStyle=color;ctx.font='50px Visitor';ctx.fillText(text,(x+_camera.x)*_settings.pixelsPerMeter,(y+_camera.y)*_settings.pixelsPerMeter);}return module};moduleFns.src_assets_js=function(){var module={exports:{},es6:{},hasES6Exports:true},exports=module.exports;var loadSound=requireES6(modules.src_engine_engine_js,'loadSound'),loadSprite=requireES6(modules.src_engine_engine_js,'loadSprite');var audioMainTheme=requireES6(modules.src_sounds_mainTheme_mp3,'default');var imgCoin=requireES6(modules.src_sprites_coin_png,'default');var audioCoin=requireES6(modules.src_sounds_coin_wav,'default');var audioStomp=requireES6(modules.src_sounds_stomp_wav,'default');var audioGameOver=requireES6(modules.src_sounds_gameOver_wav,'default');var imgGoomba=requireES6(modules.src_sprites_goomba_png,'default');var audioJump=requireES6(modules.src_sounds_jump_wav,'default');var imgMarioRunning=requireES6(modules.src_sprites_marioRunning_png,'default');var imgMarioIdle=requireES6(modules.src_sprites_marioIdle_png,'default');var imgMarioJumping=requireES6(modules.src_sprites_marioJumping_png,'default');var imgQuestionBlock=requireES6(modules.src_sprites_questionBlock_png,'default');var imgGroundBlock=requireES6(modules.src_sprites_groundBlock_png,'default');const assets={sndMainTheme:requireES6(modules.src_engine_engine_js,'loadSound')(requireES6(modules.src_sounds_mainTheme_mp3,'default')),sndCoin:requireES6(modules.src_engine_engine_js,'loadSound')(requireES6(modules.src_sounds_coin_wav,'default')),sprCoin:requireES6(modules.src_engine_engine_js,'loadSprite')(requireES6(modules.src_sprites_coin_png,'default'),0,0,2),sndStomp:requireES6(modules.src_engine_engine_js,'loadSound')(requireES6(modules.src_sounds_stomp_wav,'default')),sprGoomba:requireES6(modules.src_engine_engine_js,'loadSprite')(requireES6(modules.src_sprites_goomba_png,'default'),-8,0,2),sprMarioRunning:requireES6(modules.src_engine_engine_js,'loadSprite')(requireES6(modules.src_sprites_marioRunning_png,'default'),-8,0,2),sprMarioJumping:requireES6(modules.src_engine_engine_js,'loadSprite')(requireES6(modules.src_sprites_marioJumping_png,'default'),-8,0),sprMarioIdle:requireES6(modules.src_engine_engine_js,'loadSprite')(requireES6(modules.src_sprites_marioIdle_png,'default'),-8,0),sndJump:requireES6(modules.src_engine_engine_js,'loadSound')(requireES6(modules.src_sounds_jump_wav,'default')),sprQuestionBlock:requireES6(modules.src_engine_engine_js,'loadSprite')(requireES6(modules.src_sprites_questionBlock_png,'default'),0,0,1),sprGroundBlock:requireES6(modules.src_engine_engine_js,'loadSprite')(requireES6(modules.src_sprites_groundBlock_png,'default'),0,0),sndGameOver:requireES6(modules.src_engine_engine_js,'loadSound')(requireES6(modules.src_sounds_gameOver_wav,'default'))};module.es6.default=assets;return module};moduleFns.src_engine_utils_js=function(){var module={exports:{},es6:{},hasES6Exports:true},exports=module.exports;function unorderedList(){return {items:[],freeSpaces:[],add(value){let index=this.items.length;if(this.freeSpaces.length){index=this.freeSpaces.pop();}this.items[index]=value;return index;},remove(index){this.freeSpaces.push(index);this.items[index]=unorderedList.REMOVED_ITEM;}};}unorderedList.REMOVED_ITEM=Symbol('REMOVED_ITEM');module.es6.default={unorderedList};return module};moduleFns.src_entities_goomba_js=function(){var module={exports:{},es6:{},hasES6Exports:true},exports=module.exports;var drawSprite=requireES6(modules.src_engine_engine_js,'drawSprite'),time=requireES6(modules.src_engine_engine_js,'time'),checkCollision=requireES6(modules.src_engine_engine_js,'checkCollision'),playSound=requireES6(modules.src_engine_engine_js,'playSound'),removeEntity=requireES6(modules.src_engine_engine_js,'removeEntity'),moveAndCheckForObstacles=requireES6(modules.src_engine_engine_js,'moveAndCheckForObstacles'),settings=requireES6(modules.src_engine_engine_js,'settings'),stopSound=requireES6(modules.src_engine_engine_js,'stopSound');var assets=requireES6(modules.src_assets_js,'default');var ENTITY_TYPE_MARIO=requireES6(modules.src_entityTypes_js,'ENTITY_TYPE_MARIO'),ENTITY_TYPE_WALL=requireES6(modules.src_entityTypes_js,'ENTITY_TYPE_WALL');function updateGoomba(goomba){requireES6(modules.src_engine_engine_js,'drawSprite')(requireES6(modules.src_assets_js,'default').sprGoomba,goomba,0.1);}module.es6.updateGoomba=updateGoomba;return module};moduleFns.src_entities_wall_js=function(){var module={exports:{},es6:{},hasES6Exports:true},exports=module.exports;var addEntityType=requireES6(modules.src_engine_engine_js,'addEntityType'),settings=requireES6(modules.src_engine_engine_js,'settings'),drawSprite=requireES6(modules.src_engine_engine_js,'drawSprite');var assets=requireES6(modules.src_assets_js,'default');function updateWall(wall){requireES6(modules.src_engine_engine_js,'drawSprite')(requireES6(modules.src_assets_js,'default').sprGroundBlock,wall);}module.es6.updateWall=updateWall;return module};moduleFns.src_map_js=function(){var module={exports:{},es6:{},hasES6Exports:false},exports=module.exports;var camera=requireES6(modules.src_engine_engine_js,'camera'),createMap=requireES6(modules.src_engine_engine_js,'createMap'),playSound=requireES6(modules.src_engine_engine_js,'playSound'),stopSound=requireES6(modules.src_engine_engine_js,'stopSound');var assets=requireES6(modules.src_assets_js,'default');const asciiMapRows=['                                                          ','                                                          ','                                                          ','                                                          ','                                                          ','                                                          ','                                                          ','                                                          ','#      #                                                  ','#           ####                                          ','#           #  #                                          ','#############  ###   #####################################'];requireES6(modules.src_engine_engine_js,'camera').x=6;requireES6(modules.src_engine_engine_js,'camera').y=6;requireES6(modules.src_engine_engine_js,'createMap')(asciiMapRows);return module};moduleFns.src_sprites_groundBlock_png=function(){return {exports:'src_sprites_groundBlock_png.png'}};moduleFns.src_sprites_goomba_png=function(){return {exports:'src_sprites_goomba_png.png'}};moduleFns.src_sprites_coin_png=function(){return {exports:'src_sprites_coin_png.png'}};moduleFns.src_sounds_jump_wav=function(){return {exports:'src_sounds_jump_wav.wav'}};moduleFns.src_sounds_mainTheme_mp3=function(){return {exports:'src_sounds_mainTheme_mp3.mp3'}};moduleFns.src_sounds_stomp_wav=function(){return {exports:'src_sounds_stomp_wav.wav'}};moduleFns.src_sprites_marioIdle_png=function(){return {exports:'src_sprites_marioIdle_png.png'}};moduleFns.src_sounds_coin_wav=function(){return {exports:'src_sounds_coin_wav.wav'}};moduleFns.src_sprites_marioJumping_png=function(){return {exports:'src_sprites_marioJumping_png.png'}};moduleFns.src_sprites_questionBlock_png=function(){return {exports:'src_sprites_questionBlock_png.png'}};moduleFns.src_sprites_marioRunning_png=function(){return {exports:'src_sprites_marioRunning_png.png'}};moduleFns.src_sounds_gameOver_wav=function(){return {exports:'src_sounds_gameOver_wav.wav'}};var moduleOrder=['src_engine_utils_js','src_engine_engine_js','src_sounds_mainTheme_mp3','src_sprites_coin_png','src_sounds_coin_wav','src_sounds_stomp_wav','src_sounds_gameOver_wav','src_sprites_goomba_png','src_sounds_jump_wav','src_sprites_marioRunning_png','src_sprites_marioIdle_png','src_sprites_marioJumping_png','src_sprites_questionBlock_png','src_sprites_groundBlock_png','src_assets_js','src_entities_mario_js','src_entities_wall_js','src_entities_goomba_js','src_entities_coin_js','src_entityTypes_js','src_map_js','src_index_js'];moduleOrder.forEach((moduleName)=>modules[moduleName]=moduleFns[moduleName]());